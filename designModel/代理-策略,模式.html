<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
    
        /**
         * 一. 策略模式:定义：1 定义一系列的算法，把它们一个个封装起来，并且使它们可以相互替换
         * 场景：form表单验证， 采用switch case 这种也更适合策略模式
         * ***/
        var obj = {
            A:function(s){
                return s*3
            },
            B:function(s){
                return s*4
            },
            c:function(s){
                return s*5
            }
        }
        /**
         * 二. 代理模式：定义：为一个对象提供一个代用品或占位符，以便控制对它的访问。
         * 场景：模拟代理送花的场景
         * 面向对象的原则：单一职责原则：就一个类(通常也包括对象和函数等)而言，应该仅有一个引起它变 化的原因
         * 意义：高内聚，低耦合
         * 特性：代理和本体保持接口一致
         * ****/
         var Flower = function(){}
         var my  = {
             sendFlower:function(target){
                 var flower = new Flower()
                target.receiveFlower(flower)
             }
         }
         // 模拟代理送花
         var proxySend = {
             receiveFlower:function(flower){
                 myGirlFriend.receiveFlower(flower)
             }
         }
         var myGirlFriend = {
             receiveFlower:function(flower){
                 console.log(flower, 'flower');
             }
         }
       // my.sendFlower(proxySend)

       // 2.1 虚拟代理，实现图片预加载
       // 
       // file:///Users/liudaoyun/Desktop/1.png

       var imageNode = (function(){
           var imgNode = document.createElement('img');
           document.body.appendChild(imgNode);
           return{
               setImgSrc:function(src){
                  // console.log(src)
                   imgNode.src = src
               }
           }
       })()
       var proxyImg = (function(){
           var img = new Image();
           img.onload = function(){
               
               imageNode.setImgSrc(this.src)
           }
          return {
              setImgSrc:function(src){
                  
                  imageNode.setImgSrc('file:///Users/liudaoyun/Desktop/1.png')
                  img.src = src
              }
          }
       })()
      //  proxyImg.setImgSrc('https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1590055278393&di=6d8e5cfb5d2089da7176d4783bfc7a48&imgtype=0&src=http%3A%2F%2Fa2.att.hudong.com%2F36%2F48%2F19300001357258133412489354717.jpg')
   // 2.2 缓存代理

   var mul = function(){
       var a = 1;
       for (let index = 0; index < arguments.length; index++) {
          a *=arguments[index];
       }
       return a;
   }

   var createProxy = function(fn){
       var cache ={};
       return function(){
           var args = Array.prototype.join.call(arguments, ',');
           if(args in cache){
               return cache[args];
           }
           return cache[args] = fn.apply(this, arguments)
       }
   }
   var min = createProxy(mul);
   var j = min(1,2,3,4)
   // console.log(j)
   </script>
</body>
</html>